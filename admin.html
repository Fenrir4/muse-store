<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <title>Fenrir Admin | –í—Ö—ñ–¥</title>
    <link rel="stylesheet" href="css/base.css"> 
    <style>
        body { background: #f4f4f4; display: flex; justify-content: center; align-items: center; min-height: 100vh; font-family: 'Montserrat', sans-serif; }
        .admin-panel { background: #fff; padding: 40px; border-radius: 8px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); width: 100%; max-width: 600px; }
        .hidden { display: none !important; }
        h2 { text-align: center; margin-bottom: 20px; color: var(--primary-color); }
        input, textarea { width: 100%; padding: 12px; margin-bottom: 15px; border: 1px solid #ddd; border-radius: 4px; }
        label { font-weight: 600; font-size: 12px; display: block; margin-bottom: 5px; text-transform: uppercase; }
        .btn-admin { width: 100%; padding: 12px; background: var(--primary-color); color: #fff; border: none; cursor: pointer; text-transform: uppercase; font-weight: bold; }
        .btn-admin:hover { background: var(--accent-color); }
        .logout-btn { background: #ff4444; margin-top: 10px; }
    </style>
</head>
<body>
    
    <header>
        <div class="logo"><a href="index.html" style="text-decoration: none; color: inherit;">1 MILLILITER</a></div>
        <nav>
            <ul class="nav-links">
                <li><a href="catalog.html">–ö–∞—Ç–∞–ª–æ–≥</a></li>
                <li><a href="catalog.html">–ë—Ä–µ–Ω–¥–∏</a></li>
                <li><a href="delivery.html">–î–æ—Å—Ç–∞–≤–∫–∞</a></li>
                <li><a href="about.html">–ü—Ä–æ –Ω–∞—Å</a></li>
            </ul>
        </nav>
        <div class="burger">
            <div class="line1"></div>
            <div class="line2"></div>
            <div class="line3"></div>
        </div>
        <div class="user-actions">
            <div class="cart-btn">
                <svg class="icon-bag" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M16 11V7C16 4.79086 14.2091 3 12 3C9.79086 3 8 4.79086 8 7V11M5 9H19L20 21H4L5 9Z" 
                          stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <span class="cart-count">0</span>
            </div>
        </div>
    </header>

    <div id="login-screen" class="admin-panel">
        <h2>–í—Ö—ñ–¥ –¥–ª—è –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ üê∫</h2>
        <input type="email" id="email" placeholder="Email">
        <input type="password" id="password" placeholder="–ü–∞—Ä–æ–ª—å">
        <button class="btn-admin" onclick="login()">–£–≤—ñ–π—Ç–∏</button>
    </div>

    <div id="admin-content" class="admin-panel hidden">
        <h2>–î–æ–¥–∞—Ç–∏ –Ω–æ–≤–∏–π —Ç–æ–≤–∞—Ä</h2>
        <form id="product-form">
            <label>ID —Ç–æ–≤–∞—Ä—É</label>
            <input type="number" id="p-id" placeholder="–ù–∞–ø—Ä: 5" required>
            
            <label>–ë—Ä–µ–Ω–¥</label>
            <input type="text" id="p-brand" placeholder="Tom Ford" required>
            
            <label>–ù–∞–∑–≤–∞</label>
            <input type="text" id="p-title" placeholder="Tobacco Vanille" required>
            
            <label>–§–æ—Ç–æ (URL)</label>
            <input type="text" id="p-img" placeholder="https://..." required>
            
            <label>–û–ø–∏—Å</label>
            <textarea id="p-desc" rows="3"></textarea>
            
            <label>–í–µ—Ä—Ö–Ω—ñ –Ω–æ—Ç–∏</label>
            <input type="text" id="p-top" placeholder="–í–∏—à–Ω—è, –õ—ñ–∫–µ—Ä...">

            <label>–¶—ñ–Ω–∞ –∑–∞ —Ñ–ª–∞–∫–æ–Ω</label>
            <input type="number" id="p-price-full" required>
            
            <button type="button" class="btn-admin" onclick="saveProduct()">–ó–±–µ—Ä–µ–≥—Ç–∏ –≤ –±–∞–∑—É</button>
        </form>
        <button class="btn-admin logout-btn" onclick="logout()">–í–∏–π—Ç–∏</button>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    
    <script src="js/config.js"></script>

    <script>
        // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –∑ —Ñ–∞–π–ª—É –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó
        firebase.initializeApp(CONFIG.firebase);
        const db = firebase.database();
        const auth = firebase.auth();

        // –°–ª—É—Ö–∞—î–º–æ —Å—Ç–∞–Ω –≤—Ö–æ–¥—É
        auth.onAuthStateChanged(user => {
            if (user) {
                document.getElementById('login-screen').classList.add('hidden');
                document.getElementById('admin-content').classList.remove('hidden');
            } else {
                document.getElementById('login-screen').classList.remove('hidden');
                document.getElementById('admin-content').classList.add('hidden');
            }
        });

        function login() {
            const email = document.getElementById('email').value;
            const pass = document.getElementById('password').value;
            auth.signInWithEmailAndPassword(email, pass)
                .catch(err => alert("–ü–æ–º–∏–ª–∫–∞ –≤—Ö–æ–¥—É: " + err.message));
        }

        function logout() {
            auth.signOut();
        }

        function saveProduct() {
            const id = document.getElementById('p-id').value;
            if(!id) return alert("–í–∫–∞–∂—ñ—Ç—å ID!");

            const price = parseInt(document.getElementById('p-price-full').value);
            
            const productData = {
                id: parseInt(id),
                brand: document.getElementById('p-brand').value,
                title: document.getElementById('p-title').value,
                price: price,
                image: document.getElementById('p-img').value,
                description: document.getElementById('p-desc').value,
                notes: {
                    top: document.getElementById('p-top').value,
                    heart: "–£—Ç–æ—á–Ω—é—î—Ç—å—Å—è...",
                    base: "–£—Ç–æ—á–Ω—é—î—Ç—å—Å—è..."
                },
                options: [
                    { volume: "2 –º–ª", price: Math.round(price * 0.05) },
                    { volume: "5 –º–ª", price: Math.round(price * 0.12) },
                    { volume: "10 –º–ª", price: Math.round(price * 0.22) },
                    { volume: "–§–ª–∞–∫–æ–Ω", price: price, active: true }
                ]
            };

            db.ref('products/' + id).set(productData)
                .then(() => {
                    alert("–¢–æ–≤–∞—Ä –∑–±–µ—Ä–µ–∂–µ–Ω–æ! ‚úÖ");
                    document.getElementById('product-form').reset();
                })
                .catch(err => alert("–ü–æ–º–∏–ª–∫–∞ (–Ω–µ–º–∞—î –ø—Ä–∞–≤?): " + err.message));
        }
    </script>
</body>
</html>